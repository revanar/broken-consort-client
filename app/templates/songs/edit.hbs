
<h2>Edit Songs</h2>
<button class="btn btn-success" {{action "saveAll" "song"}}>Save All</button>
<div class="div-table table">
    <div class="table-header">
        <span>Book</span>
        <span>Song #</span>
        <span>Name</span>
        <span>Composer</span>
        <span>Parts #</span>
        <span>Text Languages</span>
        <span>Tags</span>
        <span>PDF</span>
    </div>
    {{#each model.songs as |song|}}
      <form class="table-row" {{action "autoSave" "song" on="change"}}>
        <div class="table-cell">
          {{#power-select
            selected=song.book
            options=model.books
            onchange=(action "updateOne" "song" song "book")
            searchField="name"
            as |book|
          }}
            {{book.name}} | {{book.editor.name}} | {{book.year}}
          {{/power-select}}
        </div>
        <div class="table-cell">{{input type="number" min="1" max="99" size="2" value=song.song_no}}</div>
        <div class="table-cell">{{input type="text" value=song.name}}</div>
        <div class="table-cell">
          {{#power-select-with-create
            selected=song.composer
            placeholder="unknown composer"
            options=model.composers
            onchange=(action "updateOne" "song" song "composer")
            oncreate=(action "createOne" "song" song "composer")
            searchField="name"
            as |composer|
          }}
            {{composer.name}}
          {{/power-select-with-create}}
        </div>
        <div class="table-cell">{{input type="number" min="1" max="9" size="1" value=song.parts_no}}</div>
        <div class="table-cell"><!--next up: replace mut with "updateRelation" function-->
          {{#power-select-multiple
            selected=song.languages
            options=model.languages
            placeholder="Select languages of song lyrics"
            onchange=(action "updateMany" "song" song "language")
            onkeydown=(action "createMany" "song" song "language")
            searchField="name"
            as |language|
          }}
            {{language.name}}
          {{/power-select-multiple}}
        </div>
        <div class="table-cell">
          {{#power-select-multiple
            selected=song.tags
            options=model.tags
            placeholder="Select tags for this song"
            onchange=(action "updateMany" "song" song "tag")
            onkeydown=(action "createMany" "song" song "tag")
            searchField="name"
            as |tag|
          }}
            {{tag.name}}
          {{/power-select-multiple}}
        </div>
        <div class="table-cell">
          {{#if song.pdf.pdf_path.url}}
              <div><a href={{song.pdf.pdf_path.url}}>pdf</a></div>
              <label class="btn btn-danger" for={{concat "pdf-delete-" song.id}} >
                {{input id=(concat "pdf-delete-" song.id) type="checkbox" name="Delete PDF" checked=song.remove_pdf_path}} Delete
              </label>
          {{/if}}
          {{x-file-input action=(action "uploadPDF" song) accept="application/pdf" class="btn btn-default"}}
        </div>
        <button class="btn btn-danger" {{action "deleteRecord" song}}>Delete Song</button>
        <span id="pdf-progress-{{song.id}}"></span>
        <span id="save-flash-{{song.id}}" class="save-flash">Saved!</span>
      </form>
    {{/each}}
    <button class="btn btn-default" {{action "createRecord" "song"}}>Create New Song</button>
</div>
